var cov_198scbsjon=function(){var path="D:\\Shwetha\\Projects\\DIM\\routes\\user\\register.js",hash="ae280f366aa05ae52f2c2471c788de62f27e51c8",Function=function(){}.constructor,global=new Function('return this')(),gcv="__coverage__",coverageData={path:"D:\\Shwetha\\Projects\\DIM\\routes\\user\\register.js",statementMap:{"0":{start:{line:1,column:14},end:{line:1,column:32}},"1":{start:{line:2,column:13},end:{line:2,column:29}},"2":{start:{line:3,column:17},end:{line:3,column:38}},"3":{start:{line:4,column:23},end:{line:4,column:51}},"4":{start:{line:6,column:11},end:{line:6,column:39}},"5":{start:{line:7,column:14},end:{line:7,column:45}},"6":{start:{line:10,column:17},end:{line:16,column:2}},"7":{start:{line:18,column:18},end:{line:23,column:1}},"8":{start:{line:26,column:0},end:{line:41,column:4}},"9":{start:{line:28,column:24},end:{line:28,column:40}},"10":{start:{line:29,column:21},end:{line:29,column:38}},"11":{start:{line:30,column:26},end:{line:30,column:30}},"12":{start:{line:32,column:8},end:{line:34,column:9}},"13":{start:{line:33,column:12},end:{line:33,column:55}},"14":{start:{line:35,column:8},end:{line:39,column:10}},"15":{start:{line:45,column:0},end:{line:123,column:3}},"16":{start:{line:47,column:15},end:{line:47,column:28}},"17":{start:{line:48,column:19},end:{line:48,column:36}},"18":{start:{line:49,column:19},end:{line:49,column:36}},"19":{start:{line:51,column:19},end:{line:51,column:36}},"20":{start:{line:53,column:19},end:{line:53,column:35}},"21":{start:{line:54,column:23},end:{line:54,column:27}},"22":{start:{line:55,column:19},end:{line:55,column:23}},"23":{start:{line:56,column:20},end:{line:56,column:26}},"24":{start:{line:57,column:24},end:{line:57,column:34}},"25":{start:{line:58,column:23},end:{line:58,column:33}},"26":{start:{line:60,column:16},end:{line:60,column:30}},"27":{start:{line:61,column:4},end:{line:61,column:65}},"28":{start:{line:63,column:4},end:{line:63,column:67}},"29":{start:{line:65,column:4},end:{line:65,column:70}},"30":{start:{line:66,column:4},end:{line:66,column:83}},"31":{start:{line:67,column:4},end:{line:67,column:62}},"32":{start:{line:68,column:4},end:{line:68,column:73}},"33":{start:{line:69,column:4},end:{line:69,column:89}},"34":{start:{line:72,column:17},end:{line:72,column:39}},"35":{start:{line:75,column:4},end:{line:121,column:5}},"36":{start:{line:76,column:8},end:{line:76,column:37}},"37":{start:{line:78,column:25},end:{line:88,column:10}},"38":{start:{line:89,column:8},end:{line:119,column:11}},"39":{start:{line:90,column:12},end:{line:90,column:31}},"40":{start:{line:90,column:21},end:{line:90,column:31}},"41":{start:{line:92,column:26},end:{line:104,column:14}},"42":{start:{line:106,column:12},end:{line:110,column:15}},"43":{start:{line:108,column:16},end:{line:108,column:35}},"44":{start:{line:108,column:25},end:{line:108,column:35}},"45":{start:{line:111,column:12},end:{line:111,column:38}},"46":{start:{line:112,column:12},end:{line:118,column:15}},"47":{start:{line:113,column:16},end:{line:117,column:17}},"48":{start:{line:114,column:20},end:{line:114,column:59}},"49":{start:{line:116,column:20},end:{line:116,column:67}},"50":{start:{line:120,column:8},end:{line:120,column:84}},"51":{start:{line:125,column:0},end:{line:125,column:24}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:27,column:20},end:{line:27,column:21}},loc:{start:{line:27,column:49},end:{line:40,column:5}},line:27},"1":{name:"(anonymous_1)",decl:{start:{line:45,column:17},end:{line:45,column:18}},loc:{start:{line:45,column:37},end:{line:123,column:1}},line:45},"2":{name:"(anonymous_2)",decl:{start:{line:89,column:40},end:{line:89,column:41}},loc:{start:{line:89,column:61},end:{line:119,column:9}},line:89},"3":{name:"(anonymous_3)",decl:{start:{line:106,column:35},end:{line:106,column:36}},loc:{start:{line:107,column:22},end:{line:110,column:13}},line:107},"4":{name:"(anonymous_4)",decl:{start:{line:112,column:45},end:{line:112,column:46}},loc:{start:{line:112,column:67},end:{line:118,column:13}},line:112}},branchMap:{"0":{loc:{start:{line:75,column:4},end:{line:121,column:5}},type:"if",locations:[{start:{line:75,column:4},end:{line:121,column:5}},{start:{line:75,column:4},end:{line:121,column:5}}],line:75},"1":{loc:{start:{line:90,column:12},end:{line:90,column:31}},type:"if",locations:[{start:{line:90,column:12},end:{line:90,column:31}},{start:{line:90,column:12},end:{line:90,column:31}}],line:90},"2":{loc:{start:{line:108,column:16},end:{line:108,column:35}},type:"if",locations:[{start:{line:108,column:16},end:{line:108,column:35}},{start:{line:108,column:16},end:{line:108,column:35}}],line:108},"3":{loc:{start:{line:113,column:16},end:{line:117,column:17}},type:"if",locations:[{start:{line:113,column:16},end:{line:117,column:17}},{start:{line:113,column:16},end:{line:117,column:17}}],line:113}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0]},_coverageSchema:"d34fc3e6b8297bcde183f5492bcb8fcb36775295"},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();var express=(cov_198scbsjon.s[0]++,require('express'));var router=(cov_198scbsjon.s[1]++,express.Router());var nodemailer=(cov_198scbsjon.s[2]++,require('nodemailer'));var expressValidator=(cov_198scbsjon.s[3]++,require('express-validator'));var User=(cov_198scbsjon.s[4]++,require('../../models/user'));var Account=(cov_198scbsjon.s[5]++,require('../../models/account'));var transporte=(cov_198scbsjon.s[6]++,nodemailer.createTransport({service:'gmail',auth:{user:'men.in.blue.team.manager@gmail.com',pass:'admin@MiB'}}));var mailOptions=(cov_198scbsjon.s[7]++,{from:'men.in.blue.team.manager@gmail.com',to:'',subject:'welcome to MiB Fan Club',html:'<h2>Welcome Fan </h2><p> thank you for registering with us</p><br> <p>please visit our website regularly to keep you updated </p><br><br> <p>warm Regards</p><br><p>Team MiB</p>'//express validator
});cov_198scbsjon.s[8]++;router.use(expressValidator({errorFormatter:function(param,msg,value){cov_198scbsjon.f[0]++;var namespace=(cov_198scbsjon.s[9]++,param.split('.')),root=(cov_198scbsjon.s[10]++,namespace.shift()),formParam=(cov_198scbsjon.s[11]++,root);cov_198scbsjon.s[12]++;while(namespace.length){cov_198scbsjon.s[13]++;formParam+='['+namespace.shift()+']';}cov_198scbsjon.s[14]++;return{param:formParam,msg:msg,value:value};}}));cov_198scbsjon.s[15]++;router.post('/',function(req,res){cov_198scbsjon.f[1]++;// console.log("Inside register")
var name=(cov_198scbsjon.s[16]++,req.body.name);var username=(cov_198scbsjon.s[17]++,req.body.email_id);var email_id=(cov_198scbsjon.s[18]++,req.body.email_id);//var isPrime =req.body.isPrime;
var password=(cov_198scbsjon.s[19]++,req.body.password);//var confirm = req.body.confirm;
var address=(cov_198scbsjon.s[20]++,req.body.address);var oauth_source=(cov_198scbsjon.s[21]++,null);var oauth_id=(cov_198scbsjon.s[22]++,null);var user_type=(cov_198scbsjon.s[23]++,'user');var modified_date=(cov_198scbsjon.s[24]++,Date.now());var created_date=(cov_198scbsjon.s[25]++,Date.now());var phone=(cov_198scbsjon.s[26]++,req.body.phone);cov_198scbsjon.s[27]++;req.checkBody('name','Name should not be empty').notEmpty();//req.checkBody('username','User Name should not be empty').notEmpty();
cov_198scbsjon.s[28]++;req.checkBody('phone','phone should not be empty').notEmpty();// req.checkBody('phone','phone should be 10 digits').isMobilePhone();
cov_198scbsjon.s[29]++;req.checkBody('email_id','Email should not be empty').notEmpty();cov_198scbsjon.s[30]++;req.checkBody('email_id','Account is already existing with this id').exists();cov_198scbsjon.s[31]++;req.checkBody('email_id','Email is not valid').isEmail();cov_198scbsjon.s[32]++;req.checkBody('password','Password should not be empty').notEmpty();cov_198scbsjon.s[33]++;req.check("password","one digit and min 8 , max 20 char long").isLength({min:5});//req.checkBody('confirm','Passwords do not match').equals(req.body.password);
var errors=(cov_198scbsjon.s[34]++,req.validationErrors());//console.log(errors);
cov_198scbsjon.s[35]++;if(errors){cov_198scbsjon.b[0][0]++;cov_198scbsjon.s[36]++;res.json({errors:errors});}else{cov_198scbsjon.b[0][1]++;var newAccount=(cov_198scbsjon.s[37]++,new Account({username:username,email_id:email_id,oauth_source:oauth_source,oauth_id:oauth_id,user_type:user_type,// prime_user : isPrime,
password:password,modified_date:modified_date,created_date:created_date}));cov_198scbsjon.s[38]++;Account.saveAccount(newAccount,function(err,data){cov_198scbsjon.f[2]++;cov_198scbsjon.s[39]++;if(err){cov_198scbsjon.b[1][0]++;cov_198scbsjon.s[40]++;throw err;}else{cov_198scbsjon.b[1][1]++;}//Creating User Profile
var newUser=(cov_198scbsjon.s[41]++,new User({name:name,email_id:email_id,username:email_id,phone:phone,// isPrime : isPrime,
password:password,address:address,phone:phone,account_id:data._id,modified_date:modified_date,created_date:created_date}));cov_198scbsjon.s[42]++;User.saveUser(newUser,function(err,data){cov_198scbsjon.f[3]++;cov_198scbsjon.s[43]++;if(err){cov_198scbsjon.b[2][0]++;cov_198scbsjon.s[44]++;throw err;}else{cov_198scbsjon.b[2][1]++;}//  console.log("Response from user model" + data);
});cov_198scbsjon.s[45]++;mailOptions.to=email_id;cov_198scbsjon.s[46]++;transporte.sendMail(mailOptions,function(error,res){cov_198scbsjon.f[4]++;cov_198scbsjon.s[47]++;if(error){cov_198scbsjon.b[3][0]++;cov_198scbsjon.s[48]++;console.log('some error comes',error);}else{cov_198scbsjon.b[3][1]++;cov_198scbsjon.s[49]++;console.log('mail sent succesfully',res.info);}});});cov_198scbsjon.s[50]++;res.json({message:'you have registered successfully you can login now'});}});cov_198scbsjon.s[51]++;module.exports=router;